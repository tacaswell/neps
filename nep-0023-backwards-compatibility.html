
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>NEP 23 — Backwards compatibility and deprecation policy &#8212; NumPy Enhancement Proposals</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/blank.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="NEP 27 — Zero rank arrays" href="nep-0027-zero-rank-arrarys.html" />
    <link rel="prev" title="NEP 22 — Duck typing for NumPy arrays – high level overview" href="nep-0022-ndarray-duck-typing-overview.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<link rel="stylesheet" href="_static/numpy.css" type="text/css" />

    <!-- PR #17220: This is added via javascript in versionwarning.js  -->
    <!-- link rel="canonical" href="http://numpy.org/doc/stable/nep-0023-backwards-compatibility.html" / -->


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="content.html">
  <img src="_static/numpylogo.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  Index
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="scope.html">
  The Scope of NumPy
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="roadmap.html">
  Current roadmap
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/numpy/numpy/issues?q=is%3Aopen+is%3Aissue+label%3A%2223+-+Wish+List%22">Wishlist<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/numpy/numpy" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/numpy_team" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="scope.html">
   The Scope of NumPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="roadmap.html">
   Current roadmap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/numpy/numpy/issues?q=is%3Aopen+is%3Aissue+label%3A%2223+-+Wish+List%22">
   Wish list
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0000.html">
   NEP 0 — Purpose and process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-template.html">
   NEP X — Template and instructions
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0034-infer-dtype-is-object.html">
   NEP 34 — Disallow inferring ``dtype=object`` from sequences
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0036-fair-play.html">
   NEP 36 — Fair play
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0038-SIMD-optimizations.html">
   NEP 38 — Using SIMD optimization instructions for performance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0041-improved-dtype-support.html">
   NEP 41 — First step towards a new datatype system
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0042-new-dtypes.html">
   NEP 42 — New and extensible DTypes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0044-restructuring-numpy-docs.html">
   NEP 44 — Restructuring the NumPy documentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0045-c_style_guide.html">
   NEP 45 — C style guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0046-sponsorship-guidelines.html">
   NEP 46 — NumPy sponsorship guidelines
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0021-advanced-indexing.html">
   NEP 21 — Simplified and explicit advanced indexing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0030-duck-array-protocol.html">
   NEP 30 — Duck typing for NumPy arrays - Implementation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0031-uarray.html">
   NEP 31 — Context-local and global overrides of the NumPy API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0037-array-module.html">
   NEP 37 — A dispatch protocol for NumPy-like modules
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0043-extensible-ufuncs.html">
   NEP 43 — Enhancing the extensibility of UFuncs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0047-array-api-standard.html">
   NEP 47 — Adopting the array API standard
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0048-spending-project-funds.html">
   NEP 48 — Spending NumPy project funds
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0001-npy-format.html">
   NEP 1 — A simple file format for NumPy arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0005-generalized-ufuncs.html">
   NEP 5 — Generalized Universal Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0007-datetime-proposal.html">
   NEP 7 — A proposal for implementing some date/time types in NumPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0010-new-iterator-ufunc.html">
   NEP 10 — Optimizing Iterator/UFunc performance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0013-ufunc-overrides.html">
   NEP 13 — A mechanism for overriding Ufuncs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0014-dropping-python2.7-proposal.html">
   NEP 14 — Plan for dropping Python 2.7 support
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0015-merge-multiarray-umath.html">
   NEP 15 — Merging multiarray and umath
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0018-array-function-protocol.html">
   NEP 18 — A dispatch mechanism for NumPy's high level array functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0019-rng-policy.html">
   NEP 19 — Random number generator policy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0020-gufunc-signature-enhancement.html">
   NEP 20 — Expansion of generalized universal function signatures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0022-ndarray-duck-typing-overview.html">
   NEP 22 — Duck typing for NumPy arrays – high level overview
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   NEP 23 — Backwards compatibility and deprecation policy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0027-zero-rank-arrarys.html">
   NEP 27 — Zero rank arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0028-website-redesign.html">
   NEP 28 — numpy.org website redesign
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0029-deprecation_policy.html">
   NEP 29 — Recommend Python and NumPy version support as a community policy standard
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0032-remove-financial-functions.html">
   NEP 32 — Remove the financial functions from NumPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0035-array-creation-dispatch-with-array-function.html">
   NEP 35 — Array creation dispatching with __array_function__
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0040-legacy-datatype-impl.html">
   NEP 40 — Legacy datatype implementation in NumPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0049.html">
   NEP 49 — Data allocation strategies
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0002-warnfix.html">
   NEP 2 — A proposal to build numpy without warning with a big set of warning flags
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0003-math_config_clean.html">
   NEP 3 — Cleaning the math configuration of numpy.core
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0004-datetime-proposal3.html">
   NEP 4 — A (third) proposal for implementing some date/time types in NumPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0006-newbugtracker.html">
   NEP 6 — Replacing Trac with a different bug tracker
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0008-groupby_additions.html">
   NEP 8 —  A proposal for adding groupby functionality to NumPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0009-structured_array_extensions.html">
   NEP 9 — Structured array extensions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0011-deferred-ufunc-evaluation.html">
   NEP 11 — Deferred UFunc evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0012-missing-data.html">
   NEP 12 — Missing data functionality in NumPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0024-missing-data-2.html">
   NEP 24 — Missing data functionality - Alternative 1 to NEP 12
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0025-missing-data-3.html">
   NEP 25 — NA support via special dtypes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0026-missing-data-summary.html">
   NEP 26 — Summary of missing data NEPs and discussion
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0016-abstract-array.html">
   NEP 16 — An abstract base class for identifying "duck arrays"
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nep-0017-split-out-maskedarray.html">
   NEP 17 — Split out masked arrays
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#abstract">
   Abstract
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation-and-scope">
   Motivation and Scope
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-principles">
   General principles
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#strategies-related-to-deprecations">
     Strategies related to deprecations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#impact-assessment">
       Impact assessment
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#alternatives-to-deprecations">
       Alternatives to deprecations
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementing-deprecations-and-removals">
   Implementing deprecations and removals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#decision-making">
   Decision making
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functionality-with-more-strict-deprecation-policies">
     Functionality with more strict deprecation policies
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-cases">
   Example cases
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#alternatives">
   Alternatives
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#discussion">
   Discussion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references-and-footnotes">
   References and Footnotes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#copyright">
   Copyright
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="nep-23-backwards-compatibility-and-deprecation-policy">
<span id="nep23"></span><h1>NEP 23 — Backwards compatibility and deprecation policy<a class="headerlink" href="#nep-23-backwards-compatibility-and-deprecation-policy" title="Permalink to this headline">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ralf Gommers &lt;<a class="reference external" href="mailto:ralf&#46;gommers&#37;&#52;&#48;gmail&#46;com">ralf<span>&#46;</span>gommers<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
</dd>
<dt class="field-even">Status</dt>
<dd class="field-even"><p>Final</p>
</dd>
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Process</p>
</dd>
<dt class="field-even">Created</dt>
<dd class="field-even"><p>2018-07-14</p>
</dd>
<dt class="field-odd">Resolution</dt>
<dd class="field-odd"><p><a class="reference external" href="https://mail.python.org/pipermail/numpy-discussion/2021-January/081423.html">https://mail.python.org/pipermail/numpy-discussion/2021-January/081423.html</a></p>
</dd>
</dl>
<section id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>In this NEP we describe NumPy’s approach to backwards compatibility,
its deprecation and removal policy, and the trade-offs and decision
processes for individual cases where breaking backwards compatibility
is considered.</p>
</section>
<section id="motivation-and-scope">
<h2>Motivation and Scope<a class="headerlink" href="#motivation-and-scope" title="Permalink to this headline">¶</a></h2>
<p>NumPy has a very large user base.  Those users rely on NumPy being stable
and the code they write that uses NumPy functionality to keep working.
NumPy is also actively maintained and improved – and sometimes improvements
require, or are made easier, by breaking backwards compatibility.
Finally, there are trade-offs in stability for existing users vs. avoiding
errors or having a better user experience for new users.  These competing
needs often give rise to long debates and delay accepting or rejecting
contributions.  This NEP tries to address that by providing a policy as well
as examples and rationales for when it is or isn’t a good idea to break
backwards compatibility.</p>
<p>In addition, this NEP can serve as documentation for users about how the NumPy
project treats backwards compatibility, and the speed at which they can expect
changes to be made.</p>
<p>In scope for this NEP are:</p>
<ul class="simple">
<li><p>Principles of NumPy’s approach to backwards compatibility.</p></li>
<li><p>How to deprecate functionality, and when to remove already deprecated
functionality.</p></li>
<li><p>Decision making process for deprecations and removals.</p></li>
<li><p>How to ensure that users are well informed about any change.</p></li>
</ul>
<p>Out of scope are:</p>
<ul class="simple">
<li><p>Making concrete decisions about deprecations of particular functionality.</p></li>
<li><p>NumPy’s versioning scheme.</p></li>
</ul>
</section>
<section id="general-principles">
<h2>General principles<a class="headerlink" href="#general-principles" title="Permalink to this headline">¶</a></h2>
<p>When considering proposed changes that are backwards incompatible, the
main principles the NumPy developers use when making a decision are:</p>
<ol class="arabic simple">
<li><p>Changes need to benefit more than they harm users.</p></li>
<li><p>NumPy is widely used, so breaking changes should be assumed by default to be
harmful.</p></li>
<li><p>Decisions should be based on how they affect users and downstream packages
and should be based on usage data where possible. It does not matter whether
this use contradicts the documentation or best practices.</p></li>
<li><p>The possibility of an incorrect result is worse than an error or even crash.</p></li>
</ol>
<p>When assessing the costs of proposed changes, keep in mind that most users do
not read the mailing list, do not notice deprecation warnings, and sometimes
wait more than one or two years before upgrading from their old version. And
that NumPy has millions of users, so “no one will do or use this” is likely
incorrect.</p>
<p>Benefits of proposed changes can include improved functionality, usability and
performance, as well as lower maintenance cost and improved future
extensibility.</p>
<p>Fixes for clear bugs are exempt from this backwards compatibility policy.
However, in case of serious impact on users even bug fixes may have to be
delayed for one or more releases. For example, if a downstream library would no
longer build or would give incorrect results.</p>
<section id="strategies-related-to-deprecations">
<h3>Strategies related to deprecations<a class="headerlink" href="#strategies-related-to-deprecations" title="Permalink to this headline">¶</a></h3>
<section id="impact-assessment">
<h4>Impact assessment<a class="headerlink" href="#impact-assessment" title="Permalink to this headline">¶</a></h4>
<p>Getting hard data on the impact of a deprecation of often difficult. Strategies
that can be used to assess such impact include:</p>
<ul class="simple">
<li><p>Use a code search engine (<a class="footnote-reference brackets" href="#id5" id="id1">1</a>, <a class="footnote-reference brackets" href="#id6" id="id2">2</a>) or static (<a class="footnote-reference brackets" href="#id7" id="id3">3</a>) or dynamic (<a class="footnote-reference brackets" href="#id8" id="id4">4</a>) code
analysis tools to determine where and how the functionality is used.</p></li>
<li><p>Test prominent downstream libraries against a development build of NumPy
containing the proposed change to get real-world data on its impact.</p></li>
<li><p>Make a change on the main branch and revert it before release if it
causes problems.  We encourage other packages to test against
NumPy’s main branch and if that’s too burdensome, then at least to
test pre-releases. This often turns up issues quickly.</p></li>
</ul>
</section>
<section id="alternatives-to-deprecations">
<h4>Alternatives to deprecations<a class="headerlink" href="#alternatives-to-deprecations" title="Permalink to this headline">¶</a></h4>
<p>If the impact is unclear or significant, it is often good to consider
alternatives to deprecations. For example, discouraging use in documentation
only, or moving the documentation for the functionality to a less prominent
place or even removing it completely. Commenting on open issues related to it
that they are low-prio or labeling them as “wontfix” will also be a signal to
users, and reduce the maintenance effort needing to be spent.</p>
</section>
</section>
</section>
<section id="implementing-deprecations-and-removals">
<h2>Implementing deprecations and removals<a class="headerlink" href="#implementing-deprecations-and-removals" title="Permalink to this headline">¶</a></h2>
<p>Deprecation warnings are necessary in all cases where functionality
will eventually be removed.  If there is no intent to remove functionality,
then it should not be deprecated. A “please don’t use this for new code”
in the documentation or other type of warning should be used instead, and the
documentation can be organized such that the preferred alternative is more
prominently shown.</p>
<p>Deprecations:</p>
<ul class="simple">
<li><p>shall include the version number of the release in which the functionality
was deprecated.</p></li>
<li><p>shall include information on alternatives to the deprecated functionality, or a
reason for the deprecation if no clear alternative is available. Note that
release notes can include longer messages if needed.</p></li>
<li><p>shall use <code class="docutils literal notranslate"><span class="pre">DeprecationWarning</span></code> by default, and <code class="docutils literal notranslate"><span class="pre">VisibleDeprecation</span></code>
for changes that need attention again after already having been deprecated or
needing extra attention for some reason.</p></li>
<li><p>shall be listed in the release notes of the release where the deprecation is
first present.</p></li>
<li><p>shall not be introduced in micro (bug fix) releases.</p></li>
<li><p>shall set a <code class="docutils literal notranslate"><span class="pre">stacklevel</span></code>, so the warning appears to come from the correct
place.</p></li>
<li><p>shall be mentioned in the documentation for the functionality. A
<code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">deprecated::</span></code> directive can be used for this.</p></li>
</ul>
<p>Examples of good deprecation warnings (also note standard form of the comments
above the warning, helps when grepping):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># NumPy 1.15.0, 2018-09-02</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;np.asscalar(a) is deprecated since NumPy 1.16.0, use &#39;</span>
              <span class="s1">&#39;a.item() instead&#39;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># NumPy 1.15.0, 2018-02-10</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Importing from numpy.testing.utils is deprecated &quot;</span>
              <span class="s2">&quot;since 1.15.0, import from numpy.testing instead.&quot;</span><span class="p">,</span>
              <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># NumPy 1.14.0, 2017-07-14</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
    <span class="s2">&quot;Reading unicode strings without specifying the encoding &quot;</span>
    <span class="s2">&quot;argument is deprecated since NumPy 1.14.0. Set the encoding, &quot;</span>
    <span class="s2">&quot;use None for the system default.&quot;</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">VisibleDeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cm">/* DEPRECATED 2020-05-13, NumPy 1.20 */</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyErr_WarnFormat</span><span class="p">(</span><span class="n">PyExc_DeprecationWarning</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">matrix_deprecation_msg</span><span class="p">,</span><span class="w"> </span><span class="n">ufunc</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;first&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Removal of deprecated functionality:</p>
<ul class="simple">
<li><p>shall be done after at least 2 releases assuming the current 6-monthly
release cycle; if that changes, there shall be at least 1 year between
deprecation and removal.</p></li>
<li><p>shall be listed in the release notes of the release where the removal happened.</p></li>
<li><p>can be done in any minor, but not bugfix, release.</p></li>
</ul>
<p>For backwards incompatible changes that aren’t “deprecate and remove” but for
which code will start behaving differently, a <code class="docutils literal notranslate"><span class="pre">FutureWarning</span></code> should be
used. Release notes, mentioning version number and using <code class="docutils literal notranslate"><span class="pre">stacklevel</span></code> should
be done in the same way as for deprecation warnings. A <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">versionchanged::</span></code>
directive shall be used in the documentation after the behaviour change was
made to indicate when the behavior changed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">argsort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">_NoValue</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis : int, optional</span>
<span class="sd">        Axis along which to sort. If None, the default, the flattened array</span>
<span class="sd">        is used.</span>

<span class="sd">        ..  versionchanged:: 1.13.0</span>
<span class="sd">            Previously, the default was documented to be -1, but that was</span>
<span class="sd">            in error. At some future date, the default will change to -1, as</span>
<span class="sd">            originally intended.</span>
<span class="sd">            Until then, the axis should be given explicitly when</span>
<span class="sd">            ``arr.ndim &gt; 1``, to avoid a FutureWarning.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s2">&quot;In the future the default for argsort will be axis=-1, not the &quot;</span>
        <span class="s2">&quot;current None, to match its documentation and np.argsort. &quot;</span>
        <span class="s2">&quot;Explicitly pass -1 or None to silence this warning.&quot;</span><span class="p">,</span>
        <span class="n">MaskedArrayFutureWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="decision-making">
<h2>Decision making<a class="headerlink" href="#decision-making" title="Permalink to this headline">¶</a></h2>
<p>In concrete cases where this policy needs to be applied, decisions are made according
to the <a class="reference external" href="https://docs.scipy.org/doc/numpy/dev/governance/index.html">NumPy governance model</a>.</p>
<p>All deprecations must be proposed on the mailing list in order to give everyone
with an interest in NumPy development a chance to comment. Removal of
deprecated functionality does not need discussion on the mailing list.</p>
<section id="functionality-with-more-strict-deprecation-policies">
<h3>Functionality with more strict deprecation policies<a class="headerlink" href="#functionality-with-more-strict-deprecation-policies" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">numpy.random</span></code> has its own backwards compatibility policy with additional
requirements on top of the ones in this NEP, see
<a class="reference external" href="http://www.numpy.org/neps/nep-0019-rng-policy.html">NEP 19</a>.</p></li>
<li><p>The file format of <code class="docutils literal notranslate"><span class="pre">.npy</span></code> and <code class="docutils literal notranslate"><span class="pre">.npz</span></code> files is strictly versioned
independent of the NumPy version; existing format versions must remain
backwards compatible even if a newer format version is introduced.</p></li>
</ul>
</section>
</section>
<section id="example-cases">
<h2>Example cases<a class="headerlink" href="#example-cases" title="Permalink to this headline">¶</a></h2>
<p>We now discuss a few concrete examples from NumPy’s history to illustrate
typical issues and trade-offs.</p>
<p><strong>Changing the behavior of a function</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">np.histogram</span></code> is probably the most infamous example.
First, a new keyword <code class="docutils literal notranslate"><span class="pre">new=False</span></code> was introduced, this was then switched
over to None one release later, and finally it was removed again.
Also, it has a <code class="docutils literal notranslate"><span class="pre">normed</span></code> keyword that had behavior that could be considered
either suboptimal or broken (depending on ones opinion on the statistics).
A new keyword <code class="docutils literal notranslate"><span class="pre">density</span></code> was introduced to replace it; <code class="docutils literal notranslate"><span class="pre">normed</span></code> started giving
<code class="docutils literal notranslate"><span class="pre">DeprecationWarning</span></code> only in v.1.15.0.  Evolution of <code class="docutils literal notranslate"><span class="pre">histogram</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>  <span class="c1"># v1.0.0</span>

<span class="k">def</span> <span class="nf">histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>  <span class="c1">#v1.1.0</span>

<span class="k">def</span> <span class="nf">histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1">#v1.2.0</span>

<span class="k">def</span> <span class="nf">histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1">#v1.5.0</span>

<span class="k">def</span> <span class="nf">histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1">#v1.6.0</span>

<span class="k">def</span> <span class="nf">histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1">#v1.15.0</span>
    <span class="c1"># v1.15.0 was the first release where `normed` started emitting</span>
    <span class="c1"># DeprecationWarnings</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">new</span></code> keyword was planned from the start to be temporary.  Such a plan
forces users to change their code more than once, which is almost never the
right thing to do.  Instead, a better approach here would have been to
deprecate <code class="docutils literal notranslate"><span class="pre">histogram</span></code> and introduce a new function <code class="docutils literal notranslate"><span class="pre">hist</span></code> in its place.</p>
<p><strong>Disallowing indexing with floats</strong></p>
<p>Indexing an array with floats is asking for something ambiguous, and can be a
sign of a bug in user code.  After some discussion, it was deemed a good idea
to deprecate indexing with floats.  This was first tried for the v1.8.0
release, however in pre-release testing it became clear that this would break
many libraries that depend on NumPy.  Therefore it was reverted before release,
to give those libraries time to fix their code first.  It was finally
introduced for v1.11.0 and turned into a hard error for v1.12.0.</p>
<p>This change was disruptive, however it did catch real bugs in, e.g., SciPy and
scikit-learn.  Overall the change was worth the cost, and introducing it in
the main branch first to allow testing, then removing it again before
a release, is a useful strategy.</p>
<p>Similar deprecations that also look like good examples of
cleanups/improvements:</p>
<ul class="simple">
<li><p>removing deprecated boolean indexing (in 2016, see <a class="reference external" href="https://github.com/numpy/numpy/pull/8312">gh-8312</a>)</p></li>
<li><p>deprecating truth testing on empty arrays (in 2017, see <a class="reference external" href="https://github.com/numpy/numpy/pull/9718">gh-9718</a>)</p></li>
</ul>
<p><strong>Removing the financial functions</strong></p>
<p>The financial functions (e.g. <code class="docutils literal notranslate"><span class="pre">np.pmt</span></code>) had short non-descriptive names, were
present in the main NumPy namespace, and didn’t really fit well within NumPy’s
scope.  They were added in 2008 after
<a class="reference external" href="https://mail.python.org/pipermail/numpy-discussion/2008-April/032353.html">a discussion</a>
on the mailing list where opinion was divided (but a majority in favor).
The financial functions didn’t cause a lot of overhead, however there were
still multiple issues and PRs a year for them which cost maintainer time to
deal with.  And they cluttered up the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> namespace.  Discussion on
removing them was discussed in 2013 (gh-2880, rejected) and in 2019
(<a class="reference internal" href="nep-0032-remove-financial-functions.html#nep32"><span class="std std-ref">NEP 32 — Remove the financial functions from NumPy</span></a>, accepted without significant complaints).</p>
<p>Given that they were clearly outside of NumPy’s scope, moving them to a
separate <code class="docutils literal notranslate"><span class="pre">numpy-financial</span></code> package and removing them from NumPy after a
deprecation period made sense.  That also gave users an easy way to update
their code by doing <cite>pip install numpy-financial</cite>.</p>
</section>
<section id="alternatives">
<h2>Alternatives<a class="headerlink" href="#alternatives" title="Permalink to this headline">¶</a></h2>
<p><strong>Being more aggressive with deprecations.</strong></p>
<p>The goal of being more aggressive is to allow NumPy to move forward faster.
This would avoid others inventing their own solutions (often in multiple
places), as well as be a benefit to users without a legacy code base.  We
reject this alternative because of the place NumPy has in the scientific Python
ecosystem - being fairly conservative is required in order to not increase the
extra maintenance for downstream libraries and end users to an unacceptable
level.</p>
</section>
<section id="discussion">
<h2>Discussion<a class="headerlink" href="#discussion" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://mail.python.org/pipermail/numpy-discussion/2018-July/078432.html">Mailing list discussion on the first version of this NEP in 2018</a></p></li>
<li><p><a class="reference external" href="https://mail.python.org/pipermail/numpy-discussion/2020-December/081358.html">Mailing list discussion on the Dec 2020 update of this NEP</a></p></li>
<li><p><a class="reference external" href="https://github.com/numpy/numpy/pull/18097">PR with review comments on the Dec 2020 update of this NEP</a></p></li>
</ul>
</section>
<section id="references-and-footnotes">
<h2>References and Footnotes<a class="headerlink" href="#references-and-footnotes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/numpy/numpy/issues/10156">Issue requesting semantic versioning</a></p></li>
<li><p><a class="reference external" href="https://www.python.org/dev/peps/pep-0387/">PEP 387 - Backwards Compatibility Policy</a></p></li>
</ul>
<dl class="footnote brackets">
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p><a class="reference external" href="https://searchcode.com/">https://searchcode.com/</a></p>
</dd>
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p><a class="reference external" href="https://sourcegraph.com/search">https://sourcegraph.com/search</a></p>
</dd>
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/Quansight-Labs/python-api-inspect">https://github.com/Quansight-Labs/python-api-inspect</a></p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/data-apis/python-record-api">https://github.com/data-apis/python-record-api</a></p>
</dd>
</dl>
</section>
<section id="copyright">
<h2>Copyright<a class="headerlink" href="#copyright" title="Permalink to this headline">¶</a></h2>
<p>This document has been placed in the public domain.</p>
</section>
</section>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2017-2018, NumPy Developers.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>